"use strict";function Router(o,e){o.state("register",{url:"/register",templateUrl:"/templates/register.html",controller:"RegisterController as register"}).state("login",{url:"/login",templateUrl:"/templates/login.html",controller:"LoginController as login"}).state("menu",{url:"/menu",templateUrl:"/templates/menu.html"}).state("boardsIndex",{url:"/boards",templateUrl:"/templates/boardsIndex.html",controller:"BoardsIndexController as boardsIndex"}).state("boardsNew",{url:"/boards/new",templateUrl:"/templates/boardsNew.html",controller:"BoardsNewController as boardsNew"}).state("userBoards",{url:"/boards/me",templateUrl:"/templates/userBoards.html",controller:"UserBoardsController as userBoards"}).state("boardsFollowing",{url:"/boards/following",templateUrl:"/templates/boardsFollowing.html",controller:"BoardsFollowingController as boardsFollowing"}).state("boardsShow",{url:"/boards/:id",templateUrl:"/templates/boardsShow.html",controller:"BoardsShowController as boardsShow"}).state("boardsEdit",{url:"/boards/:id/edit",templateUrl:"/templates/boardsEdit.html",controller:"BoardsEditController as boardsEdit"}).state("pinsShow",{url:"/pins/:id",templateUrl:"/templates/pinsShow.html",controller:"PinsShowController as pinsShow"}),e.otherwise("/")}function Auth(o){o.tokenPrefix="",o.loginUrl="/login",o.signupUrl="/register",o.facebook({clientId:"592951794244851"}),o.instagram({clientId:"64171eadf0914dd7bf7839bc034e42e0"})}function WhiteList(o){o.resourceUrlWhitelist(["self","https://www.youtube.com/**"])}function RegisterController(o,e){function r(){o.signup(t.user).then(function(){e.go("login")})}var t=this;t.user={},t.submit=r}function LoginController(o,e){function r(){o.login(n.credentials).then(function(){e.go("menu")})}function t(r){o.authenticate(r).then(function(){e.go("menu"),console.log("Is this running")})}var n=this;n.credentials={},n.submit=r,n.authenticate=t}function Board(o){return new o("/boards/:id",{id:"@_id"},{update:{method:"PUT"}})}function boardCard(o){return{restrict:"E",replace:!0,templateUrl:"templates/boardCard.html",scope:{board:"="},link:function(e){e.images=e.board.pins.map(function(e){return"image"===e.type?e.link:"youtube"===e.type?"http://i3.ytimg.com/vi/"+o.getCode(e.link)+"/hqdefault.jpg":void 0}).slice(0,3)}}}function BoardsIndexController(o){function e(o){var e=new RegExp(r.queryString,"i"),t=o.pins.map(function(o){return o.title}).join(", ");return e.test(o.title)||e.test(o.tags)||e.test(t)}var r=this;r.queryString="",r.filter=e,r.all=o.query()}function BoardsFollowingController(o,e){var r=this,t=e.getPayload();r.all=o.query({followedBy:t._id})}function BoardsNewController(o,e){function r(){o.save(t.board,function(o){e.go("boardsShow",{id:o._id})})}var t=this;t.board={},t.create=r}function UserBoardsController(o,e,r){function t(o){s.currentBoard=o,s.formEditVisible=!0}function n(){console.log("clicked hide form!"),s.formEditVisible=!1}function l(e){o.update({id:e._id,boardId:r.params.id},e)}function i(o){s.deleteBoard=o,console.log("clicked",s.deleteBoard),s.deleteVerificationVisible=!0}function a(){s.deleteVerificationVisible=!1}function d(){console.log("DELETED!",s.deleteBoard),s.deleteBoard.$remove(function(){r.reload()})}var s=this;s.formEditVisible=!1,s.deleteVerificationVisible=!1,s.currentBoard,s.deleteBoard;var u=e.getPayload();s.all=o.query({user:u._id}),s.delete=d,s.showDeleteVerification=i,s.showEditForm=t,s.hideEditForm=n,s.updateBoard=l,s.hideDeleteVerification=a}function BoardsShowController(o,e,r,t){function n(){C.formVisible=!0}function l(){C.formVisible=!1,C.newPin={}}function i(){e.save({boardId:r.params.id},C.newPin,function(){C.pin={},l(),C.board=o.get(r.params)})}function a(e){C.copyPin=e,delete C.copyPin._id;var r=t.getPayload();C.all=o.query({user:r._id}),console.log("clicked",C.all),C.formCopyVisible=!0}function d(o){e.save({boardId:o._id},C.copyPin,function(){r.reload()})}function s(){C.formCopyVisible=!1}function u(o){C.formEditVisible=!0,C.currentPin=o,C.pinContentVisible=!1}function c(){C.formEditVisible=!1}function p(o){C.currentPin=o,console.log("clicked!",o),C.pinContentVisible=!0}function f(){C.pinContentVisible=!1}function g(o){console.log("clicked!",o),u(o)}function m(o){console.log("delete me",o),e.remove({id:o._id,boardId:r.params.id},function(){r.reload()})}function b(o){e.update({id:o._id,boardId:r.params.id},o)}function h(){C.board.followedBy.push(v),C.board.$update(function(o){console.log("succes, followed board:",o),C.following=!0})}function w(){var o=C.board.followedBy.indexOf(v);C.board.followedBy.splice(o,1),C.board.$update(function(o){console.log("succes, unfollowed board:",o),C.following=!1})}var C=this,B=t.getPayload(),v=B._id;C.following=!1,C.isOwnBoard=!1,C.formVisible=!1,C.formEditVisible=!1,C.showPinContent=!1,C.board=o.get(r.params,function(){C.board.followedBy.indexOf(v)>-1&&(C.following=!0),C.board.user._id===v&&(C.isOwnBoard=!0,console.log(!0))}),C.newPin={},C.showCreateForm=n,C.hideCreateForm=l,C.showCopyForm=a,C.copyPinToBoard=d,C.hideCopyForm=s,C.deletePin=m,C.unfollowBoard=w,C.followBoard=h,C.updateBoard=b,C.showEditForm=u,C.hideEditForm=c,C.createPin=i,C.showPin=g,C.showPinContent=p,C.hidePinContent=f}function BoardsEditController(o,e){function r(){t.board.$update(function(){console.log("clicked"),e.go("boardsShow",e.params)})}var t=this;t.board=o.get(e.params),t.updateBoard=r}function dragDrop(){var o=new FileReader;return{restrict:"E",replace:!0,templateUrl:"templates/dragDrop.html",scope:{base64:"="},link:function(e,r){e.base64=null,e.active=!1,o.onload=function(){e.base64=o.result,e.$apply()},r.on("dragover",function(){e.active=!0,e.$apply()}).on("dragover",function(o){o.preventDefault()}).on("dragleave",function(){e.active=!1,e.$apply()}).on("drop",function(e){e.preventDefault();var r=(e.target.files||e.dataTransfer.files)[0];o.readAsDataURL(r)})}}}function MainController(o,e){function r(){o.logout().then(function(){e.go("login")})}var t=this;t.isLoggedIn=o.isAuthenticated,t.logout=r}function Pin(o){return new o("/boards/:boardId/pins/:id",{id:"@_id"},{update:{method:"PUT"}})}function PinsShowController(o,e){function r(){t.pin.$remove(function(){e.go("boardsShow")})}var t=this;t.pin=o.get(e.params),t.delete=r}function PinsEditController(o,e){function r(){t.pin.$update(function(){e.go("pinsShow",e.params)})}var t=this;t.pin=o.get(e.params),t.update=r}function UploadController(){var o=this;o.data={}}function youtube(o){return{restrict:"E",replace:!0,scope:{link:"@",width:"@",height:"@"},template:'<iframe width="{{ width }}" height="{{ height }}" src="{{ src }}" frameborder="0" allowfullscreen></iframe>',link:function(e){e.src="https://www.youtube.com/embed/"+o.getCode(e.link)}}}function youtubeService(){function o(o){var e=null,r=o.match(/\?v=(.*)/);return e=r?r[1]:o.split("/").splice(-1)[0]}this.getCode=o}angular.module("boardApp",["ngResource","ui.router","satellizer"]).config(Router).config(Auth).config(WhiteList),Router.$inject=["$stateProvider","$urlRouterProvider"],Auth.$inject=["$authProvider"],WhiteList.$inject=["$sceDelegateProvider"],angular.module("boardApp").controller("RegisterController",RegisterController).controller("LoginController",LoginController),RegisterController.$inject=["$auth","$state"],LoginController.$inject=["$auth","$state"],angular.module("boardApp").factory("Board",Board),Board.$inject=["$resource"],angular.module("boardApp").directive("boardCard",boardCard),boardCard.$inject=["youtubeService"],angular.module("boardApp").controller("BoardsIndexController",BoardsIndexController).controller("BoardsFollowingController",BoardsFollowingController).controller("BoardsNewController",BoardsNewController).controller("BoardsShowController",BoardsShowController).controller("BoardsEditController",BoardsEditController).controller("UserBoardsController",UserBoardsController),BoardsIndexController.$inject=["Board"],BoardsFollowingController.$inject=["Board","$auth"],BoardsNewController.$inject=["Board","$state"],UserBoardsController.$inject=["Board","$auth","$state"],BoardsShowController.$inject=["Board","Pin","$state","$auth"],BoardsEditController.$inject=["Board","$state"],angular.module("boardApp").directive("dragDrop",dragDrop),angular.module("boardApp").controller("MainController",MainController),MainController.$inject=["$auth","$state"],angular.module("boardApp").factory("Pin",Pin),Pin.$inject=["$resource"],angular.module("boardApp").controller("PinsShowController",PinsShowController).controller("PinsEditController",PinsEditController),PinsShowController.$inject=["Pin","$state"],PinsEditController.$inject=["Pin","$state"],angular.module("boardApp").controller("UploadController",UploadController),angular.module("boardApp").directive("youtube",youtube),youtube.$inject=["youtubeService"],angular.module("boardApp").service("youtubeService",youtubeService);
//# sourceMappingURL=app.js.map
